{
  "id": "task_107_password",
  "name": "Password Strength Validator",
  "description": "Validate password strength with multiple rules",
  "tier": "tier2_contracts",
  "prompt": "Create a PasswordValidator class with the following:\n- `__init__(self, min_length=8, require_upper=True, require_lower=True, require_digit=True, require_special=True)`\n- `validate(self, password: str) -> tuple[bool, list[str]]` - Returns (is_valid, list_of_violations)\n- `strength_score(self, password: str) -> int` - Returns score 0-100 based on how well password meets criteria\n\nRules to check:\n1. Minimum length (configurable)\n2. Contains uppercase letter (if required)\n3. Contains lowercase letter (if required)\n4. Contains digit (if required)\n5. Contains special character !@#$%^&*()_+-= (if required)\n\nThe strength_score should be higher for longer passwords and more variety of character types. Place the implementation in src/core/password.py",
  "initial_files": {},
  "test_file": "import pytest\nimport sys\nsys.path.insert(0, 'src')\nfrom core.password import PasswordValidator\n\ndef test_valid_password():\n    v = PasswordValidator()\n    is_valid, violations = v.validate(\"Password1!\")\n    assert is_valid is True\n    assert len(violations) == 0\n\ndef test_too_short():\n    v = PasswordValidator(min_length=8)\n    is_valid, violations = v.validate(\"Pass1!\")\n    assert is_valid is False\n    assert any(\"length\" in v.lower() for v in violations)\n\ndef test_missing_uppercase():\n    v = PasswordValidator()\n    is_valid, violations = v.validate(\"password1!\")\n    assert is_valid is False\n\ndef test_missing_digit():\n    v = PasswordValidator()\n    is_valid, violations = v.validate(\"Password!\")\n    assert is_valid is False\n\ndef test_strength_score_weak():\n    v = PasswordValidator(require_upper=False, require_lower=False, require_digit=False, require_special=False)\n    score = v.strength_score(\"aaaaaaaa\")\n    assert score < 50\n\ndef test_strength_score_strong():\n    v = PasswordValidator()\n    score = v.strength_score(\"MyStr0ng!Password123\")\n    assert score > 70\n",
  "hidden_test_file": "import pytest\nimport sys\nsys.path.insert(0, 'src')\nfrom core.password import PasswordValidator\n\ndef test_empty_password():\n    v = PasswordValidator()\n    is_valid, violations = v.validate(\"\")\n    assert is_valid is False\n    assert len(violations) >= 1\n\ndef test_all_requirements_disabled():\n    v = PasswordValidator(min_length=1, require_upper=False, require_lower=False, require_digit=False, require_special=False)\n    is_valid, violations = v.validate(\"a\")\n    assert is_valid is True\n\ndef test_special_chars_variety():\n    v = PasswordValidator()\n    is_valid, _ = v.validate(\"Password1@\")\n    assert is_valid is True\n    is_valid, _ = v.validate(\"Password1#\")\n    assert is_valid is True\n    is_valid, _ = v.validate(\"Password1_\")\n    assert is_valid is True\n\ndef test_only_special_chars():\n    v = PasswordValidator(require_upper=False, require_lower=False, require_digit=False)\n    is_valid, violations = v.validate(\"!@#$%^&*\")\n    assert is_valid is True\n\ndef test_multiple_violations():\n    v = PasswordValidator(min_length=12)\n    is_valid, violations = v.validate(\"abc\")\n    assert is_valid is False\n    assert len(violations) >= 3  # too short, no upper, no digit, no special\n\ndef test_unicode_characters():\n    v = PasswordValidator(require_upper=False, require_special=False)\n    is_valid, _ = v.validate(\"password123\")\n    assert is_valid is True\n\ndef test_strength_increases_with_length():\n    v = PasswordValidator(require_upper=False, require_lower=False, require_digit=False, require_special=False)\n    short_score = v.strength_score(\"aaaa\")\n    long_score = v.strength_score(\"aaaaaaaaaaaaaaaa\")\n    assert long_score > short_score\n",
  "expected_files": ["src/core/password.py"],
  "tags": ["class", "validation", "security", "rules"],
  "difficulty": "medium"
}
