{
  "id": "exercism_luhn",
  "name": "Luhn",
  "description": "Exercism: luhn",
  "tier": "tier2_contracts",
  "prompt": "# Instructions\n\nGiven a number determine whether or not it is valid per the Luhn formula.\n\nThe [Luhn algorithm][luhn] is a simple checksum formula used to validate a variety of identification numbers, such as credit card numbers and Canadian Social Insurance Numbers.\n\nThe task is to check if a given string is valid.\n\n## Validating a Number\n\nStrings of length 1 or less are not valid.\nSpaces are allowed in the input, but they should be stripped before checking.\nAll other non-digit characters are disallowed.\n\n### Example 1: valid credit card number\n\n```text\n4539 3195 0343 6467\n```\n\nThe first step of the Luhn algorithm is to double every second digit, starting from the right.\nWe will be doubling\n\n```text\n4_3_ 3_9_ 0_4_ 6_6_\n```\n\nIf doubling the number results in a number greater than 9 then subtract 9 from the product.\nThe results of our doubling:\n\n```text\n8569 6195 0383 3437\n```\n\nThen sum all of the digits:\n\n```text\n8+5+6+9+6+1+9+5+0+3+8+3+3+4+3+7 = 80\n```\n\nIf the sum is evenly divisible by 10, then the number is valid.\nThis number is valid!\n\n### Example 2: invalid credit card number\n\n```text\n8273 1232 7352 0569\n```\n\nDouble the second digits, starting from the right\n\n```text\n7253 2262 5312 0539\n```\n\nSum the digits\n\n```text\n7+2+5+3+2+2+6+2+5+3+1+2+0+5+3+9 = 57\n```\n\n57 is not evenly divisible by 10, so this number is not valid.\n\n[luhn]: https://en.wikipedia.org/wiki/Luhn_algorithm\n\nPlace the implementation in src/core/luhn.py\n\nUse @pre and @post decorators from the deal library to specify contracts.",
  "initial_files": {},
  "test_file": "import pytest\nimport sys\nsys.path.insert(0, 'src')\nfrom core.luhn import *\n\n# These tests are auto-generated with test data from:\n# https://github.com/exercism/problem-specifications/tree/main/exercises/luhn/canonical-data.json\n# File last updated on 2023-07-19\n\nimport unittest\n\nfrom luhn import (\nLuhn,\n)\n\n\n\ndef test_single_digit_strings_can_not_be_valid(self):\n    assertIs(Luhn(\"1\").valid(), False)\n\ndef test_a_single_zero_is_invalid(self):\n    assertIs(Luhn(\"0\").valid(), False)\n\ndef test_a_simple_valid_sin_that_remains_valid_if_reversed(self):\n    assertIs(Luhn(\"059\").valid(), True)\n\ndef test_a_simple_valid_sin_that_becomes_invalid_if_reversed(self):\n    assertIs(Luhn(\"59\").valid(), True)\n\ndef test_a_valid_canadian_sin(self):\n    assertIs(Luhn(\"055 444 285\").valid(), True)\n\ndef test_invalid_canadian_sin(self):\n    assertIs(Luhn(\"055 444 286\").valid(), False)\n\ndef test_invalid_credit_card(self):\n    assertIs(Luhn(\"8273 1232 7352 0569\").valid(), False)\n\ndef test_invalid_long_number_with_an_even_remainder(self):\n    assertIs(Luhn(\"1 2345 6789 1234 5678 9012\").valid(), False)\n\ndef test_invalid_long_number_with_a_remainder_divisible_by_5(self):\n    assertIs(Luhn(\"1 2345 6789 1234 5678 9013\").valid(), False)\n\ndef test_valid_number_with_an_even_number_of_digits(self):\n    assertIs(Luhn(\"095 245 88\").valid(), True)\n\ndef test_valid_number_with_an_odd_number_of_spaces(self):\n    assertIs(Luhn(\"234 567 891 234\").valid(), True)\n\ndef test_valid_strings_with_a_non_digit_added_at_the_end_become_invalid(self):\n    assertIs(Luhn(\"059a\").valid(), False)\n\ndef test_valid_strings_with_punctuation_included_become_invalid(self):\n    assertIs(Luhn(\"055-444-285\").valid(), False)\n\ndef test_valid_strings_with_symbols_included_become_invalid(self):\n    assertIs(Luhn(\"055# 444$ 285\").valid(), False)\n\ndef test_single_zero_with_space_is_invalid(self):\n    assertIs(Luhn(\" 0\").valid(), False)\n\ndef test_more_than_a_single_zero_is_valid(self):\n    assertIs(Luhn(\"0000 0\").valid(), True)\n\ndef test_input_digit_9_is_correctly_converted_to_output_digit_9(self):\n    assertIs(Luhn(\"091\").valid(), True)\n\ndef test_very_long_input_is_valid(self):\n    assertIs(Luhn(\"9999999999 9999999999 9999999999 9999999999\").valid(), True)\n\ndef test_valid_luhn_with_an_odd_number_of_digits_and_non_zero_first_digit(self):\n    assertIs(Luhn(\"109\").valid(), True)\n\ndef test_using_ascii_value_for_non_doubled_non_digit_isn_t_allowed(self):\n    assertIs(Luhn(\"055b 444 285\").valid(), False)\n\ndef test_using_ascii_value_for_doubled_non_digit_isn_t_allowed(self):\n    assertIs(Luhn(\":9\").valid(), False)\n\ndef test_non_numeric_non_space_char_in_the_middle_with_a_sum_that_s_divisible_by_10_isn_t_allowed(\n    self,\n):\n    assertIs(Luhn(\"59%59\").valid(), False)\n\n# Additional tests for this track\n\ndef test_is_valid_can_be_called_repeatedly(self):\n    # This test was added, because we saw many implementations\n    # in which the first call to valid() worked, but the\n    # second call failed().\n    number = Luhn(\"055 444 285\")\n    assertIs(number.valid(), True)\n    assertIs(number.valid(), True)\n",
  "hidden_test_file": "import pytest\nimport sys\nsys.path.insert(0, 'src')\nfrom core.luhn import *\n\n# Support both ValueError and deal.PreContractError for contract violations\ntry:\n    import deal\n    CONTRACT_ERROR = (ValueError, deal.PreContractError)\nexcept ImportError:\n    CONTRACT_ERROR = ValueError\n\n\n# Edge case tests for luhn\n# These test boundary conditions and error handling\n\ndef test_edge_case_empty_input():\n    \"\"\"Test behavior with empty input if applicable.\"\"\"\n    # This is a placeholder - actual edge cases depend on the function\n    pass\n\ndef test_edge_case_large_input():\n    \"\"\"Test behavior with large input if applicable.\"\"\"\n    pass\n",
  "expected_files": [
    "src/core/luhn.py"
  ],
  "tags": [
    "exercism",
    "tier2"
  ],
  "difficulty": "hard"
}